<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewData["Title"] - In Vinh Phát</title>
    <meta name="description" content="Công ty TNHH Sản xuất Thương mại in Vinh Phát - Đơn vị tiên phong trong lĩnh vực in nhanh kỹ thuật số tại TP Hải Dương.">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Site CSS -->
    <link href="~/css/shared.css" rel="stylesheet" />
    <link href="~/css/site.css" rel="stylesheet" />
    <link href="~/css/navbar.css" rel="stylesheet" />
    <link href="~/css/Mega Menu.css" rel="stylesheet" />
    <link href="~/css/search.css" rel="stylesheet" />
    <link href="~/css/AdminControls.css" rel="stylesheet" />
    <link href="~/css/baogia.css" rel="stylesheet" />

    <!-- Slick Carousel CSS -->
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.css"/>
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick-theme.css"/>

    <!-- Styles Section (Optional) -->
    @await RenderSectionAsync("Styles", required: false)
</head>
<body>
    @using quangcao.Models
    @inject Microsoft.AspNetCore.Http.IHttpContextAccessor HttpContextAccessor
    @{
        bool isAuthenticated = HttpContextAccessor.HttpContext.User.Identity.IsAuthenticated;
        string userName = isAuthenticated ? HttpContextAccessor.HttpContext.User.Identity.Name : "";
        bool isAdmin = HttpContextAccessor.HttpContext.User.IsInRole("Admin");
        ViewData["IsAdmin"] = isAdmin;
    }

    <!-- Header -->
    <header class="site-header">
        <!-- Top Bar -->
        <div class="top-bar">
            <div class="container">
                <div class="top-bar-content">
                    <div class="address">
                        <i class="fas fa-map-marker-alt"></i>
                        <p style="margin-bottom:0">Khu Công Nghiệp Thạch Khôi, Hải Dương, Việt Nam</p>
                    </div>
                    <div class="contact-info">
                        <div class="phone">
                            <i class="fas fa-phone"></i>
                            <span>Hotline: 0977 344 567</span>
                        </div>
                        <div class="social-links">
                            <a href="https://facebook.com/profile.php?id=61575271242570" target="_blank" rel="noopener noreferrer" class="social-icon">
                                <i class="fab fa-facebook-f"></i>
                              </a>
                            <a href="mailto:invinhphat6868@gmail.com" class="social-icon">
                                <i class="fas fa-envelope"></i>
                              </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Navigation -->
        <nav class="main-nav">
            <div class="container">
                <div class="nav-wrapper">
                    <div class="logo">
                        <a asp-controller="Home" asp-action="Index">
                            <span class="logo-text">IN VINH PHÁT</span>
                          </a>
                    </div>


                    <!-- Replace your current dropdown in the nav-links section with this mega menu -->
                    <div class="nav-links" id="navLinks">
                        <a asp-controller="Home" asp-action="Index" class="nav-item">Trang Chủ  </a>
                        <a asp-controller="Home" asp-action="Privacy" class="nav-item">Giới Thiệu  </a>

                        <!-- Mega Menu -->
                        <div class="nav-item has-mega-menu">
                            <a asp-controller="SanPhams" asp-action="Index" class="nav-link">Sản Phẩm  </a>

                            <!-- Mega Menu Content -->
                            <div class="mega-menu">
                                <div class="container">
                                    <div class="mega-menu-content">
                                        <div class="mega-menu-column">
                                            <h3 class="mega-menu-title">In Ấn Văn Phòng</h3>
                                            <ul class="mega-menu-list">
                                                <li><a asp-controller="SanPhams" asp-action="Index" asp-route-currentCategory="Danh Thiếp">Danh Thiếp  </a></li>
                                                <li><a asp-controller="SanPhams" asp-action="Index" asp-route-currentCategory="Giấy Tiêu Đề">Giấy Tiêu Đề  </a></li>
                                                <li><a asp-controller="SanPhams" asp-action="Index" asp-route-currentCategory="Hóa Đơn Bán Lẻ">Hóa Đơn Bán Lẻ  </a></li>
                                                <li><a asp-controller="SanPhams" asp-action="Index" asp-route-currentCategory="In Catalogue">In Catalogue  </a></li>
                                                <li><a asp-controller="SanPhams" asp-action="Index" asp-route-currentCategory="In Chứng Chỉ-Giấy Khen">In Chứng Chỉ-Giấy Khen  </a></li>
                                                <li><a asp-controller="SanPhams" asp-action="Index" asp-route-currentCategory="In Kẹp File-Folder">In Kẹp File-Folder  </a></li>
                                                <li><a asp-controller="SanPhams" asp-action="Index" asp-route-currentCategory="In Phong Bì-Envelope">In Phong Bì-Envelope  </a></li>
                                            </ul>
                                        </div>

                                        <div class="mega-menu-column">
                                            <h3 class="mega-menu-title">Ấn Phẩm Tiếp Thị</h3>
                                            <ul class="mega-menu-list">
                                                <li><a asp-controller="SanPhams" asp-action="Index" asp-route-currentCategory="In Menu-Thực Đơn">In Menu-Thực Đơn  </a></li>
                                                <li><a asp-controller="SanPhams" asp-action="Index" asp-route-currentCategory="In Tờ Rơi-Tờ Gấp">In Tờ Rơi-Tờ Gấp  </a></li>
                                                <li><a asp-controller="SanPhams" asp-action="Index" asp-route-currentCategory="Phiếu Quà Tặng">Phiếu Quà Tặng  </a></li>
                                            </ul>
                                        </div>

                                        <div class="mega-menu-column">
                                            <h3 class="mega-menu-title">In Bao Bì & Nhãn Mác</h3>
                                            <ul class="mega-menu-list">
                                                <li><a asp-controller="SanPhams" asp-action="Index" asp-route-currentCategory="In Hộp Giấy">In Hộp Giấy  </a></li>
                                                <li><a asp-controller="SanPhams" asp-action="Index" asp-route-currentCategory="In Túi Giấy">In Túi Giấy  </a></li>
                                                <li><a asp-controller="SanPhams" asp-action="Index" asp-route-currentCategory="In Nhãn Mác Sản Phẩm">In Nhãn Mác Sản Phẩm  </a></li>
                                                <li><a asp-controller="SanPhams" asp-action="Index" asp-route-currentCategory="In Tem Nhãn">In Tem Nhãn  </a></li>
                                                <li><a asp-controller="SanPhams" asp-action="Index" asp-route-currentCategory="In Phiếu Bảo Hành">In Phiếu Bảo Hành  </a></li>
                                                <li><a asp-controller="SanPhams" asp-action="Index" asp-route-currentCategory="In Decal">In Decal  </a></li>
                                            </ul>
                                        </div>

                                        <div class="mega-menu-column">
                                            <h3 class="mega-menu-title">Quà Tặng</h3>
                                            <ul class="mega-menu-list">
                                                <li><a asp-controller="SanPhams" asp-action="Index" asp-route-currentCategory="Bao Lì Xì">Bao Lì Xì  </a></li>
                                                <li><a asp-controller="SanPhams" asp-action="Index" asp-route-currentCategory="In Lịch Tết">In Lịch Tết  </a></li>
                                                <li><a asp-controller="SanPhams" asp-action="Index" asp-route-currentCategory="Sổ Bìa Da">Sổ Bìa Da  </a></li>
                                                <li><a asp-controller="SanPhams" asp-action="Index" asp-route-currentCategory="Sổ Lò Xo">Sổ Lò Xo  </a></li>
                                                <li><a asp-controller="SanPhams" asp-action="Index" asp-route-currentCategory="Sổ Note">Sổ Note  </a></li>
                                            </ul>
                                        </div>

                                        <div class="mega-menu-column">
                                            <h3 class="mega-menu-title">Ấn Phẩm Khác</h3>
                                            <ul class="mega-menu-list">
                                                <li><a asp-controller="SanPhams" asp-action="Index" asp-route-currentCategory="Thiệp Chúc Mừng">Thiệp Chúc Mừng  </a></li>
                                                <li><a asp-controller="SanPhams" asp-action="Index" asp-route-currentCategory="Thiệp Cưới">Thiệp Cưới  </a></li>
                                                <li><a asp-controller="SanPhams" asp-action="Index" asp-route-currentCategory="Vở Học Sinh">Vở Học Sinh  </a></li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="nav-item has-mega-menu">
                            <a class="nav-link">Báo Giá  </a>
                            <div class="mega-menu">
                                <div class="container">
                                    <div class="mega-menu-content">
                                        <div class="mega-menu-column">
                                            <ul class="mega-menu-list baogia-grid-list">
                                                @await Component.InvokeAsync("BaoGiaList")
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <a asp-controller="TinTucs" asp-action="Index" class="nav-item">Tin Tức  </a>
                        <a asp-controller="LienHes" asp-action="Create" class="nav-item">Liên Hệ  </a>
                    </div>

                    <div class="nav-right">
                        <div class="search-container">
                            <form asp-controller="Search" asp-action="Index" method="get" class="search-form">
                                <div class="search-input-wrapper">
                                    <input type="text" name="keyword" id="searchInput" placeholder="Tìm kiếm sản phẩm..." required>
                                    <button type="submit" class="search-button">
                                        <i class="fas fa-search"></i>
                                    </button>
                                </div>
                            </form>
                        </div>

                        <div class="account-dropdown" id="accountDropdown">
                            @if (isAuthenticated)
                            {
                                <div class="account-trigger">
                                    <div class="user-avatar">
                                        <i class="fas fa-user" id="defaultAvatar"></i>
                                    </div>
                                    <div class="account-info">
                                        <span class="account-label">@userName</span>
                                        <i class="fas fa-chevron-down"></i>
                                    </div>
                                </div>
                                <div class="account-menu">
                                    @if (isAdmin)
                                    {
                                        <div class="admin-menu">
                                            <a asp-controller="SanPhams" asp-action="Quan-li-san-pham" class="account-menu-item">
                                                <i class="fas fa-cogs"></i> Quản lý sản phẩm
                                              </a>
                                            <a asp-controller="TinTucs" asp-action="Quan-li-tin-tuc" class="account-menu-item">
                                                <i class="fas fa-box"></i> Quản Lý Tin Tức
                                              </a>
                                            <a asp-controller="LienHes" asp-action="Index" class="account-menu-item">
                                                <i class="fas fa-users"></i> Quản lý liên hệ
                                              </a>
                                            <a asp-controller="Home" asp-action="CapNhatGioiThieu" class="account-menu-item">
                                                <i class="fas fa-info-circle"></i> Quản lý giới thiệu
                                              </a>
                                            <a asp-controller="Home" asp-action="CapNhatNhanVien" class="account-menu-item">
                                                <i class="fas fa-user-friends"></i> Quản lý đội ngũ
                                              </a>
                                        </div>
                                    }
                                    <div class="menu-divider"></div>
                                    <form asp-controller="Account" asp-action="LogOff" method="post" id="logoutForm">
                                        @Html.AntiForgeryToken()
                                        <a href="javascript:document.getElementById('logoutForm').submit()" class="account-menu-item logout-item">
                                            <i class="fas fa-sign-out-alt"></i> Đăng xuất
                                          </a>
                                    </form>
                                </div>
                            }
                        </div>

                        <!-- Mobile menu toggle is placed here, inside nav-right -->
                        <button class="menu-toggle" id="menuToggle" aria-label="Mở menu điều hướng">
                            <i class="fas fa-bars"></i>
                        </button>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Mobile Navigation -->
        <div class="mobile-nav" id="mobileNav">
            <div class="mobile-links">
                <a asp-controller="Home" asp-action="Index" class="mobile-link-title">Trang Chủ</a>
                <a asp-controller="Home" asp-action="Privacy" class="mobile-link-title">Giới Thiệu</a>
                <div class="mobile-mega-category">
                    <button class="mobile-link-title mobile-accordion-toggle" type="button" aria-expanded="false">
                        Sản Phẩm
                        <span class="mobile-accordion-icon"><i class="fas fa-chevron-down"></i></span>
                    </button>
                    <div class="mobile-mega-list" style="display:none;">
                        @await Component.InvokeAsync("SanPhamList")
                    </div>
                </div>
                <div class="mobile-mega-category">
                    <button class="mobile-link-title mobile-accordion-toggle" type="button" aria-expanded="false">
                        Báo Giá
                        <span class="mobile-accordion-icon"><i class="fas fa-chevron-down"></i></span>
                    </button>
                    <div class="mobile-mega-list" style="display: none;">
                        @await Component.InvokeAsync("BaoGiaList")
                    </div>
                </div>
                <a asp-controller="TinTucs" asp-action="Index" class="mobile-link-title">Tin Tức</a>
                <a asp-controller="LienHes" asp-action="Create" class="mobile-link-title">Liên Hệ</a>
                </div>
            </div>
        </div>
    </header>

    <script>
      document.addEventListener('DOMContentLoaded', function () {
        function isMobile() {
          return window.innerWidth <= 768;
        }
        function setupMobileAccordion() {
          if (!isMobile()) return;
          document.querySelectorAll('.mobile-mega-category').forEach(function (cat) {
            var btn = cat.querySelector('.mobile-accordion-toggle');
            var list = cat.querySelector('.mobile-mega-list');
            if (!btn || !list) return;
            btn.addEventListener('click', function () {
              var expanded = btn.getAttribute('aria-expanded') === 'true';
              btn.setAttribute('aria-expanded', !expanded);
              if (expanded) {
                list.style.display = 'none';
              } else {
                list.style.display = 'block';
              }
            });
            // Mặc định mở
            btn.setAttribute('aria-expanded', 'true');
            list.style.display = 'block';
          });
        }
        setupMobileAccordion();
        window.addEventListener('resize', function () {
          // Reset lại khi resize qua lại giữa mobile/desktop
          document.querySelectorAll('.mobile-mega-category').forEach(function (cat) {
            var btn = cat.querySelector('.mobile-accordion-toggle');
            var list = cat.querySelector('.mobile-mega-list');
            if (!btn || !list) return;
            if (isMobile()) {
              btn.setAttribute('aria-expanded', 'true');
              list.style.display = 'block';
            } else {
              list.style.display = '';
            }
          });
        });
      });
    </script>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            @RenderBody()
        </div>
    </main>

    <!-- Footer -->
    <footer class="site-footer">
        <div class="footer-main">
            <div class="container">
                <div class="footer-grid">
                    <div class="footer-about">
                        <h3>Về chúng tôi</h3>
                        <p>Công ty TNHH Sản xuất Thương mại in Vinh Phát - Đơn vị tiên phong trong lĩnh vực in nhanh kỹ thuật số tại TP Hải Dương.</p>
                        <div class="footer-social">
                            <a href="https://facebook.com/profile.php?id=61575271242570" target="_blank" rel="noopener noreferrer">
                                <i class="fab fa-facebook-f"></i>
                              </a>
                            <a href="#" target="_blank" rel="noopener noreferrer">
                                <i class="fab fa-youtube"></i>
                              </a>
                            <a href="#" target="_blank" rel="noopener noreferrer">
                                <i class="fab fa-instagram"></i>
                              </a>
                        </div>
                    </div>
                    <div class="footer-services">
                        <h3>Dịch vụ</h3>
                        <ul>
                            <li><a href="/san-pham/to-roi">In tờ rơi  </a></li>
                            <li><a href="/san-pham/name-card">In name card  </a></li>
                            <li><a href="/san-pham/tui-giay">In túi giấy  </a></li>
                            <li><a href="/san-pham/banner">In banner  </a></li>
                        </ul>
                    </div>
                    <div class="footer-contact">
                        <h3>Liên hệ</h3>
                        <div class="contact-item">
                            <i class="fas fa-map-marker-alt"></i>
                            <p>Khu Công Nghiệp Thạch Khôi, Hải Dương, Việt Nam</p>
                        </div>
                        <div class="contact-item">
                            <i class="fas fa-envelope"></i>
                            <p><a href="mailto:invinhphat6868@gmail.com">invinhphat6868@gmail.com  </a></p>
                        </div>
                        <div class="contact-item">
                            <i class="fas fa-phone"></i>
                            <p><a href="tel:0977344567">Hotline: 0977 344 567  </a></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <div class="container">
                <p>&copy; <span id="currentYear">2025</span> Công ty TNHH Sản xuất Thương mại in Vinh Phát - Tất cả quyền lợi được bảo lưu.</p>
            </div>
        </div>
    </footer>

    <!-- Admin Controls -->
    @await Html.PartialAsync("AdminControls")

    <!-- Scripts -->
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Slick Carousel JS -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js"></script>
    <!-- Site-wide scripts -->
    <script src="~/js/site.js" asp-append-version="true"></script>

    <!-- Scripts Section (Optional) -->
    @await RenderSectionAsync("Scripts", required: false)


</body>
</html>
